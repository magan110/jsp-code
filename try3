using Microsoft.AspNetCore.Mvc;
using sparshWebService.DataAccess;
using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;

namespace sparshWebService.Controllers
{
    [Route("api/[controller]")]
    [ApiController]
    [Produces("application/json")]
    public class ActivityEntryController : ControllerBase
    {
        private readonly DatabaseHelper _db;

        public ActivityEntryController(DatabaseHelper db)
        {
            _db = db;
        }

        // ----------------------------------------------------
        // GET: /api/ActivityEntry/ping
        // ----------------------------------------------------
        [HttpGet("ping")]
        public IActionResult Ping()
        {
            return Ok(new { success = true, controller = "ActivityEntry", message = "Ping OK" });
        }

        // ----------------------------------------------------
        // POST: /api/ActivityEntry/save
        // ----------------------------------------------------
        [HttpPost("save")]
        [Consumes("application/json")]
        public IActionResult Save([FromBody] ActivityEntryRequest? request)
        {
            try
            {
                request ??= new ActivityEntryRequest();

                // ========= BASIC VALIDATION (ONLY FLUTTER FIELDS) =========
                if (string.IsNullOrWhiteSpace(request.LoginIdn))
                    return BadRequest(new { success = false, message = "LoginIdn is required from Flutter." });

                if (string.IsNullOrWhiteSpace(request.AreaCode))
                    return BadRequest(new { success = false, message = "AreaCode is required from Flutter." });

                if (string.IsNullOrWhiteSpace(request.ActivityName))
                    return BadRequest(new { success = false, message = "ActivityName is required." });

                if (string.IsNullOrWhiteSpace(request.MeetingVenue))
                    return BadRequest(new { success = false, message = "MeetingVenue is required." });

                if (string.IsNullOrWhiteSpace(request.CityName))
                    return BadRequest(new { success = false, message = "CityName is required." });

                if (string.IsNullOrWhiteSpace(request.ActivityDate))
                    return BadRequest(new { success = false, message = "ActivityDate is required." });

                var actvDate = SafeParseDate(request.ActivityDate);
                if (actvDate == null)
                    return BadRequest(new { success = false, message = "ActivityDate is invalid." });

                // ========= NORMALIZED VALUES FROM FLUTTER =========
                string createId = Cut(request.LoginIdn!.Trim(), 10);   // createId varchar(10)
                string updateId = createId;
                string areaCode = Cut(request.AreaCode!.Trim(), 3);   // areaCode varchar(3)

                string processType = (request.ProcessType ?? "Add").Trim().ToUpperInvariant();
                bool isAdd = processType == "ADD";

                // -------- docuNumb via wcpDocNoGen (docuType = AEF) --------
                string docuNumb;
                if (isAdd)
                {
                    string finYear = DateTime.Now.ToString("yy", CultureInfo.InvariantCulture);
                    // docuType fixed as AEF
                    docuNumb = GenerateDocuNumber("AEF", finYear, areaCode);
                    if (string.IsNullOrWhiteSpace(docuNumb))
                        return StatusCode(500, new { success = false, message = "Could not generate document number." });
                }
                else
                {
                    if (string.IsNullOrWhiteSpace(request.DocuNumb))
                        return BadRequest(new { success = false, message = "DocuNumb is required in Update mode." });
                    docuNumb = Cut(request.DocuNumb!, 16);
                }

                docuNumb = Cut(docuNumb, 16);                         // docuNumb char(16)
                string docuMnth = actvDate.Value.ToString("yyyyMM");  // docuMnth char(6)
                string maturtMn = docuMnth;                           // maturtMn char(6)

                // Activity / place details from Flutter
                string actvName = Cut(request.ActivityName!, 100);    // actvName varchar(100)
                string actvCity = Cut(request.CityName!, 40);         // actvCity varchar(40)
                string district = Cut(request.District ?? "", 30);    // district varchar(30) (you can map Emirate text here)
                string prodName = Cut(request.Product ?? "", 50);     // prodCtLs varchar(50)
                string meetVenu = Cut(request.MeetingVenue!, 50);     // meetVenu varchar(50)
                string actvRmrk = Cut(request.Description ?? "", 200);// actvRmrk varchar(200)

                string locaCapr = Cut(
                    $"{request.MeetingVenue}, {request.CityName}, {district}".Trim(' ', ','),
                    250); // locaCapr varchar(250)

                string latitude = Cut(request.Latitude ?? "", 50);    // latitude/latitute varchar(50)
                string longitude = Cut(request.Longitude ?? "", 50);  // longtude/lgtitute varchar(50)

                string userRole = Cut(request.UserRole ?? "", 1);     // userRole char(1)

                // ========= COUNTS =========
                int empCount = request.Employees?.Count ?? 0;
                int inflCount = request.Painters?.Count ?? 0;
                int chnlCount = request.ChannelPartners?.Count ?? 0;

                int totalParticipants =
                    request.TotalParticipants ??
                    empCount + inflCount + chnlCount;

                string empContStr = Cut(empCount.ToString(CultureInfo.InvariantCulture), 4);   // emplCont char(4)
                string inflContStr = Cut(inflCount.ToString(CultureInfo.InvariantCulture), 4); // inflCont char(4)
                string chnlContStr = Cut(chnlCount.ToString(CultureInfo.InvariantCulture), 4); // chnlCont char(4)
                string totlContStr = Cut(totalParticipants.ToString(CultureInfo.InvariantCulture), 4); // totlCont char(4)

                // ========= EMPLOYEE PRESENT LIST =========
                string empPrsLs = "";
                if (request.Employees != null && request.Employees.Count > 0)
                {
                    var codes = request.Employees
                        .Where(e => !string.IsNullOrWhiteSpace(e.EmployeeCode))
                        .Select(e => e.EmployeeCode!.Trim())
                        .ToList();
                    empPrsLs = Cut(string.Join(",", codes), 100); // empPrsLs varchar(100)
                }

                // ========= PRIMARY CONTACT (FROM FLUTTER) =========
                string primaryName = "";
                string primaryMobile = "";
                if (request.Painters != null && request.Painters.Count > 0)
                {
                    var first = request.Painters[0];
                    primaryName = first.Name ?? "";
                    primaryMobile = first.Mobile ?? "";
                }
                else if (request.Employees != null && request.Employees.Count > 0)
                {
                    var first = request.Employees[0];
                    primaryName = first.Name ?? "";
                    primaryMobile = first.Mobile ?? "";
                }

                string contPers = Cut(primaryName, 40);                       // contPers varchar(40)
                string mobile11 = Cut(FormatMobile11(primaryMobile), 11);    // mobileNo varchar(11)
                string contNumb = Cut(FormatMobile10(primaryMobile), 10);    // contNumb varchar(10)

                // ========= HEADER RETAILER CODE (FIRST CHANNEL PARTNER) =========
                string cusRtlCd = "";
                if (request.ChannelPartners != null && request.ChannelPartners.Count > 0)
                {
                    var firstRet = request.ChannelPartners[0];
                    cusRtlCd = Cut(firstRet.PurchaserCode ?? "", 10);         // cusRtlCd varchar(10)
                }

                // ========= IMAGES FROM FLUTTER =========
                string atchNmId = "";
                if (request.ImageIds != null && request.ImageIds.Count > 0)
                {
                    atchNmId = Cut(string.Join("|", request.ImageIds), 500);  // atchNmId varchar(500)
                }

                // ========= HEADER: INSERT OR UPDATE =========
                if (isAdd)
                {
                    var p = new Dictionary<string, object?>
                    {
                        ["@docuNumb"] = docuNumb,
                        ["@docuMnth"] = docuMnth,
                        ["@actvDate"] = actvDate.Value,
                        ["@meetDate"] = actvDate.Value,
                        ["@actvName"] = actvName,
                        // from Flutter we don't have explicit codes => keep empty
                        ["@caaActTy"] = "",     // caaActTy char(2)
                        ["@caaObjTy"] = "",     // caaObjTy char(2)
                        ["@actvCity"] = actvCity,
                        ["@district"] = district,
                        ["@pinCodeN"] = "",     // no pincode in Flutter => ""
                        ["@noOfPart"] = totalParticipants,
                        ["@noOfEnqu"] = 0,
                        ["@noOfVist"] = 0,
                        ["@prodCtLs"] = prodName,
                        ["@empPrsLs"] = empPrsLs,
                        ["@actvRmrk"] = actvRmrk,
                        ["@meetVenu"] = meetVenu,
                        ["@caaPrjTy"] = "",     // caaPrjTy char(2)
                        ["@mobileNo"] = mobile11,
                        ["@emailAdd"] = "",     // not in Flutter
                        ["@contPers"] = contPers,
                        ["@potnInMT"] = 0,
                        ["@maturtMn"] = maturtMn,
                        ["@rejcRmrk"] = "",
                        ["@statFlag"] = "N",
                        ["@createId"] = createId,
                        ["@createDt"] = DateTime.Now,
                        ["@updateId"] = DBNull.Value,
                        ["@updateDt"] = DBNull.Value,
                        ["@locaCapr"] = locaCapr,
                        ["@latitute"] = latitude,
                        ["@lgtitute"] = longitude,
                        ["@atchNmId"] = atchNmId,
                        ["@urbRurFl"] = "",     // no field in Flutter
                        ["@contNumb"] = contNumb,
                        ["@sitePtCl"] = DBNull.Value,
                        ["@cusRtlCd"] = cusRtlCd,
                        ["@mxBdgtAl"] = DBNull.Value,
                        ["@refDocNo"] = DBNull.Value,
                        ["@bwAvgSpg"] = DBNull.Value,
                        ["@bwAvgDis"] = DBNull.Value,
                        ["@bwAvgPrm"] = DBNull.Value,
                        ["@budgType"] = "",
                        ["@areaCode"] = areaCode,
                        ["@repoCatg"] = "",     // no value in Flutter
                        ["@latitude"] = latitude,
                        ["@longtude"] = longitude,
                        ["@meetType"] = "",     // no value in Flutter
                        ["@custName"] = "",
                        ["@custMobl"] = "",
                        ["@custMail"] = "",
                        ["@arctName"] = "",
                        ["@arctMobl"] = "",
                        ["@arctMail"] = "",
                        ["@grcItems"] = "",
                        ["@sqftQnty"] = "",
                        ["@timeFrme"] = "",
                        ["@autoCadd"] = "",     // no value in Flutter
                        ["@userRole"] = userRole,
                        ["@cusStkCd"] = "",
                        ["@segment1"] = "",
                        ["@emplCont"] = empContStr,
                        ["@chnlCont"] = chnlContStr,
                        ["@inflCont"] = inflContStr,
                        ["@totlCont"] = totlContStr,
                        ["@pendwith"] = "",
                        ["@remarks1"] = "",
                        ["@grcStsFl"] = ""
                    };

                    string sql = @"
INSERT INTO dbo.catActPreSl
(
    docuNumb, docuMnth, actvDate, meetDate, actvName, caaActTy, caaObjTy,
    actvCity, district, pinCodeN, noOfPart, noOfEnqu, noOfVist,
    prodCtLs, empPrsLs, actvRmrk, meetVenu, caaPrjTy,
    mobileNo, emailAdd, contPers, potnInMT, maturtMn, rejcRmrk,
    statFlag, createId, createDt, updateId, updateDt,
    locaCapr, latitute, lgtitute, atchNmId, urbRurFl, contNumb,
    sitePtCl, cusRtlCd, mxBdgtAl, refDocNo, bwAvgSpg, bwAvgDis, bwAvgPrm,
    budgType, areaCode, repoCatg, latitude, longtude, meetType,
    custName, custMobl, custMail, arctName, arctMobl, arctMail,
    grcItems, sqftQnty, timeFrme, autoCadd, userRole, cusStkCd,
    segment1, emplCont, chnlCont, inflCont, totlCont, pendwith,
    remarks1, grcStsFl
)
VALUES
(
    @docuNumb, @docuMnth, @actvDate, @meetDate, @actvName, @caaActTy, @caaObjTy,
    @actvCity, @district, @pinCodeN, @noOfPart, @noOfEnqu, @noOfVist,
    @prodCtLs, @empPrsLs, @actvRmrk, @meetVenu, @caaPrjTy,
    @mobileNo, @emailAdd, @contPers, @potnInMT, @maturtMn, @rejcRmrk,
    @statFlag, @createId, @createDt, @updateId, @updateDt,
    @locaCapr, @latitute, @lgtitute, @atchNmId, @urbRurFl, @contNumb,
    @sitePtCl, @cusRtlCd, @mxBdgtAl, @refDocNo, @bwAvgSpg, @bwAvgDis, @bwAvgPrm,
    @budgType, @areaCode, @repoCatg, @latitude, @longtude, @meetType,
    @custName, @custMobl, @custMail, @arctName, @arctMobl, @arctMail,
    @grcItems, @sqftQnty, @timeFrme, @autoCadd, @userRole, @cusStkCd,
    @segment1, @emplCont, @chnlCont, @inflCont, @totlCont, @pendwith,
    @remarks1, @grcStsFl
);

SELECT @docuNumb AS DocuNumb;";

                    var res = _db.QaEWebBean(sql, p);
                    var row = res?.FirstOrDefault();
                    string savedDocu = row?["DocuNumb"]?.ToString() ?? docuNumb;

                    // ========= INSERT DETAILS (ONLY FIELDS FROM FLUTTER, OTHERS "") =========
                    InsertDetails(savedDocu, createId, request);

                    return Ok(new
                    {
                        success = true,
                        message = "Activity saved successfully.",
                        docuNumb = savedDocu,
                        timestamp = DateTime.Now
                    });
                }
                else
                {
                    // BASIC UPDATE (only fields that exist in Flutter)
                    var p = new Dictionary<string, object?>
                    {
                        ["@docuNumb"] = docuNumb,
                        ["@actvDate"] = actvDate.Value,
                        ["@meetDate"] = actvDate.Value,
                        ["@actvName"] = actvName,
                        ["@actvCity"] = actvCity,
                        ["@district"] = district,
                        ["@prodCtLs"] = prodName,
                        ["@empPrsLs"] = empPrsLs,
                        ["@actvRmrk"] = actvRmrk,
                        ["@meetVenu"] = meetVenu,
                        ["@mobileNo"] = mobile11,
                        ["@contPers"] = contPers,
                        ["@noOfPart"] = totalParticipants,
                        ["@locaCapr"] = locaCapr,
                        ["@latitute"] = latitude,
                        ["@lgtitute"] = longitude,
                        ["@atchNmId"] = atchNmId,
                        ["@updateId"] = updateId,
                        ["@updateDt"] = DateTime.Now,
                        ["@userRole"] = userRole
                    };

                    string sql = @"
UPDATE dbo.catActPreSl
SET
    actvDate = @actvDate,
    meetDate = @meetDate,
    actvName = @actvName,
    actvCity = @actvCity,
    district = @district,
    prodCtLs = @prodCtLs,
    empPrsLs = @empPrsLs,
    actvRmrk = @actvRmrk,
    meetVenu = @meetVenu,
    mobileNo = @mobileNo,
    contPers = @contPers,
    noOfPart = @noOfPart,
    locaCapr = @locaCapr,
    latitute = @latitute,
    lgtitute = @lgtitute,
    atchNmId = @atchNmId,
    updateId = @updateId,
    updateDt = @updateDt,
    userRole = @userRole
WHERE docuNumb = @docuNumb;

SELECT @docuNumb AS DocuNumb;";

                    var res = _db.QaEWebBean(sql, p);
                    var row = res?.FirstOrDefault();
                    string savedDocu = row?["DocuNumb"]?.ToString() ?? docuNumb;

                    return Ok(new
                    {
                        success = true,
                        message = "Activity updated successfully.",
                        docuNumb = savedDocu,
                        timestamp = DateTime.Now
                    });
                }
            }
            catch (Exception ex)
            {
                return StatusCode(500, new
                {
                    success = false,
                    message = "Error while saving activity.",
                    error = ex.Message,
                    timestamp = DateTime.Now
                });
            }
        }

        // -------------------- DETAIL INSERT --------------------
        private void InsertDetails(string docuNumb, string createId, ActivityEntryRequest request)
        {
            string sql = @"
INSERT INTO dbo.catActPreSlDtl
(
    docuNumb, attnType, attnCode,
    statFlag, createId, createDt,
    updateId, updateDt,
    retlCode, tlKitFlg, nwPntFlg,
    atchNmId, dsrRem09, dsrRem08, dsrRem07,
    oldKycFl, sampFlag, appDownd, giftType, dsrRem06
)
VALUES
(
    @docuNumb, @attnType, @attnCode,
    @statFlag, @createId, @createDt,
    @updateId, @updateDt,
    @retlCode, @tlKitFlg, @nwPntFlg,
    @atchNmId, @dsrRem09, @dsrRem08, @dsrRem07,
    @oldKycFl, @sampFlag, @appDownd, @giftType, @dsrRem06
);

SELECT 1 AS Done;";

            // Employees => attnType = 'E'
            if (request.Employees != null)
            {
                foreach (var emp in request.Employees)
                {
                    string empCode = Cut(emp.EmployeeCode ?? "", 10); // attnCode varchar(10)
                    string name = Cut(emp.Name ?? "", 100);           // dsrRem08 varchar(100)
                    string mob = Cut(emp.Mobile ?? "", 100);          // dsrRem07 varchar(100)
                    string full = Cut($"{name}|{mob}", 500);          // dsrRem09 varchar(500)

                    var p = new Dictionary<string, object?>
                    {
                        ["@docuNumb"] = Cut(docuNumb, 16),
                        ["@attnType"] = "E",
                        ["@attnCode"] = empCode,
                        ["@statFlag"] = "N",
                        ["@createId"] = createId,
                        ["@createDt"] = DateTime.Now,
                        ["@updateId"] = DBNull.Value,
                        ["@updateDt"] = DBNull.Value,
                        ["@retlCode"] = "",        // not from Flutter => ""
                        ["@tlKitFlg"] = "",
                        ["@nwPntFlg"] = "",
                        ["@atchNmId"] = "",
                        ["@dsrRem09"] = full,
                        ["@dsrRem08"] = name,
                        ["@dsrRem07"] = mob,
                        ["@oldKycFl"] = "",
                        ["@sampFlag"] = "",
                        ["@appDownd"] = "",
                        ["@giftType"] = "",
                        ["@dsrRem06"] = ""
                    };

                    _db.QaEWebBean(sql, p);
                }
            }

            // Painters/Contractors/Applicators => attnType = 'P'
            if (request.Painters != null)
            {
                foreach (var pt in request.Painters)
                {
                    string name = Cut(pt.Name ?? "", 100);
                    string mob = Cut(pt.Mobile ?? "", 100);
                    string full = Cut($"{pt.Type}|{name}|{mob}", 500);
                    string attnCode = Cut(FormatMobile10(pt.Mobile ?? ""), 10);

                    var p = new Dictionary<string, object?>
                    {
                        ["@docuNumb"] = Cut(docuNumb, 16),
                        ["@attnType"] = "P",
                        ["@attnCode"] = attnCode,
                        ["@statFlag"] = "N",
                        ["@createId"] = createId,
                        ["@createDt"] = DateTime.Now,
                        ["@updateId"] = DBNull.Value,
                        ["@updateDt"] = DBNull.Value,
                        ["@retlCode"] = "",
                        ["@tlKitFlg"] = "",
                        ["@nwPntFlg"] = "",
                        ["@atchNmId"] = "",
                        ["@dsrRem09"] = full,
                        ["@dsrRem08"] = name,
                        ["@dsrRem07"] = mob,
                        ["@oldKycFl"] = "",
                        ["@sampFlag"] = "",
                        ["@appDownd"] = "",
                        ["@giftType"] = "",
                        ["@dsrRem06"] = ""
                    };

                    _db.QaEWebBean(sql, p);
                }
            }

            // Channel Partners => attnType = 'C'
            if (request.ChannelPartners != null)
            {
                foreach (var ch in request.ChannelPartners)
                {
                    string name = Cut(ch.Name ?? "", 100);
                    string mob = Cut(ch.Mobile ?? "", 100);
                    string full = Cut($"{ch.Type}|{name}|{mob}", 500);
                    string attnCode = Cut(ch.PurchaserCode ?? "", 10);
                    string retlCode = Cut(ch.PurchaserCode ?? "", 8); // retlCode varchar(8)

                    var p = new Dictionary<string, object?>
                    {
                        ["@docuNumb"] = Cut(docuNumb, 16),
                        ["@attnType"] = "C",
                        ["@attnCode"] = attnCode,
                        ["@statFlag"] = "N",
                        ["@createId"] = createId,
                        ["@createDt"] = DateTime.Now,
                        ["@updateId"] = DBNull.Value,
                        ["@updateDt"] = DBNull.Value,
                        ["@retlCode"] = retlCode,
                        ["@tlKitFlg"] = "",
                        ["@nwPntFlg"] = "",
                        ["@atchNmId"] = "",
                        ["@dsrRem09"] = full,
                        ["@dsrRem08"] = name,
                        ["@dsrRem07"] = mob,
                        ["@oldKycFl"] = "",
                        ["@sampFlag"] = "",
                        ["@appDownd"] = "",
                        ["@giftType"] = "",
                        ["@dsrRem06"] = ""
                    };

                    _db.QaEWebBean(sql, p);
                }
            }
        }

        // -------------------- DOC NO GENERATOR --------------------
        private string GenerateDocuNumber(string docuType, string finYear, string areaCode)
        {
            var p = new Dictionary<string, object?>
            {
                ["@docuType"] = docuType,   // "AEF"
                ["@finYear"] = finYear,
                ["@areaCode"] = areaCode
            };

            // NOTE: only parameters used by proc, no @docuNumb here
            var rows = _db.QaEWebBean("EXEC dbo.wcpDocNoGen @docuType, @finYear, @areaCode", p);
            var first = rows?.FirstOrDefault();
            if (first == null || first.Count == 0)
                return "";

            // Take first column as document number
            var val = first.Values.FirstOrDefault();
            return val?.ToString() ?? "";
        }

        // -------------------- HELPERS --------------------
        private static string Cut(string? s, int max)
        {
            if (string.IsNullOrWhiteSpace(s)) return "";
            var t = s.Trim();
            return t.Length <= max ? t : t.Substring(0, max);
        }

        private static DateTime? SafeParseDate(string? dateString)
        {
            if (string.IsNullOrWhiteSpace(dateString)) return null;
            var formats = new[]
            {
                "yyyy-MM-dd","dd/MM/yyyy","MM/dd/yyyy",
                "yyyy/MM/dd","dd-MM-yyyy","MM-dd-yyyy",
                "yyyyMMdd","ddMMyyyy"
            };
            foreach (var f in formats)
            {
                if (DateTime.TryParseExact(dateString, f, CultureInfo.InvariantCulture,
                        DateTimeStyles.None, out var dt))
                    return dt;
            }
            if (DateTime.TryParse(dateString, out var any)) return any;
            return null;
        }

        private static string Digits(string? s)
        {
            if (string.IsNullOrEmpty(s)) return "";
            return new string(s.Where(char.IsDigit).ToArray());
        }

        private static string FormatMobile11(string? s)
        {
            var d = Digits(s);
            if (d.Length <= 11) return d;
            return d.Substring(d.Length - 11);
        }

        private static string FormatMobile10(string? s)
        {
            var d = Digits(s);
            if (d.Length <= 10) return d;
            return d.Substring(d.Length - 10);
        }
    }

    // ================== DTOs (match Flutter data) ==================

    public class ActivityEntryRequest
    {
        public string? ProcessType { get; set; }      // Add / Update
        public string? DocuNumb { get; set; }         // For Update

        public string? ActivityName { get; set; }     // from activityController
        public string? Description { get; set; }      // from descriptionController
        public string? ActivityDate { get; set; }     // activityDateController (yyyy-MM-dd)
        public string? MeetingVenue { get; set; }     // meetingVenueController
        public string? CityName { get; set; }         // cityNameController
        public string? District { get; set; }         // Emirate text (if you map)
        public string? Product { get; set; }          // prodController

        public int? TotalParticipants { get; set; }   // totalParticipantsController (optional)

        public string? Latitude { get; set; }         // latitudeController
        public string? Longitude { get; set; }        // longitudeController

        public string? LoginIdn { get; set; }         // Sparsh login ID (createId/updateId)
        public string? UserRole { get; set; }         // 'S','P', etc. (if available)
        public string? AreaCode { get; set; }         // _selectedEmirate.code (3 char)

        public List<ActivityEmployeeItem> Employees { get; set; } = new();
        public List<ActivityPainterItem> Painters { get; set; } = new();
        public List<ActivityChannelPartnerItem> ChannelPartners { get; set; } = new();
        public List<string>? ImageIds { get; set; }   // from uploaded images
    }

    public class ActivityEmployeeItem
    {
        public string? EmployeeCode { get; set; }     // employeesList[index]['employeeCode']
        public string? Name { get; set; }             // employeesList[index]['name']
        public string? Mobile { get; set; }           // employeesList[index]['mobile']
    }

    public class ActivityPainterItem
    {
        public string? Type { get; set; }             // Painter / Contractor / Applicator
        public string? Name { get; set; }             // painterList row['nameController']
        public string? Mobile { get; set; }           // painterList row['mobileController']
    }

    public class ActivityChannelPartnerItem
    {
        public string? Type { get; set; }             // Authorsied dealer / Retailer / etc.
        public string? PurchaserCode { get; set; }    // row.purchaserCodeController
        public string? Name { get; set; }             // row.nameController
        public string? Mobile { get; set; }           // row.mobileController
    }
}
